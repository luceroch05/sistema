<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Web Notas</title>
    <link rel="stylesheet" type="text/css" href="styles.css">

    <script src="https://unpkg.com/xlsx@0.16.9/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/file-saverjs@latest/FileSaver.min.js"></script>
    <script src="https://unpkg.com/tableexport@latest/dist/js/tableexport.min.js"></script>
</head>

<body>
    <div class="indice-contenedor">
        <div class="indice">
            <div class="navegacion">
                <ul>
                    <li><a href="#"><span class="icon" id="home"><ion-icon name="home-outline"></ion-icon></span><span class="title">Inicio</span></a></li>
                    <li><a href="#"><span class="icon" id="estadisticas"><ion-icon name="stats-chart-outline"></ion-icon></span><span class="title">Notas</span></a></li>
                    <li><a href="#"><span class="icon" id="user"><ion-icon name="person-circle-outline"></ion-icon></span><span class="title">Perfil</span></a></li>
                    <li><a href="#"><span class="icon"><ion-icon name="help-circle-outline"></ion-icon></span><span class="title">Ayuda</span></a></li>
                    <li><a href="#"><span class="icon" id="salir"><ion-icon name="close-circle-outline"></ion-icon></span><span class="title">Cerrar</span></a></li>
                </ul>
            </div>
        </div>
    </div>

    <section>
        <div class="contenedor">
            <div class="panel-login">
                <img src="imagenes/user.png" class="mi-imagen" alt="Imagen de usuario">
                <form action="" method="post">
                    <div class="input-container">
                        <input type="text" id="username" name="username" required>
                        <label for="username">Usuario</label>
                    </div>
                    <div class="input-container">
                        <input type="password" id="password" name="password" required>
                        <label for="password">Contraseña</label>
                    </div><br>
                    <button type="button" id="login-button">Ingresar</button>
                </form>
            </div>
        </div>

        <div class="panel-interfaz">
            <div class="cont-bienvenido">
                <div class="welcome-message">
                    <h1>Hola Lucero!</h1>
                    <p>Es bueno verte de nuevo.</p>
                </div>
                <div class="welcome-image">
                    <img src="imagenes/uweb.jpg" alt="VectorBienvenidaUsuario">
                </div>
            </div>

            <div class="cursos-container">
                <div class="curso1" id="c1">
                    <h2>POO</h2>
                    <p>Java</p>
                </div>
                <div class="curso2" id="c2">
                    <h2>Base de datos</h2>
                    <p>SQL Server</p>
                </div>
                <div class="curso3" id="c3">
                    <h2>Programación Distribuida</h2>
                    <p>C#</p>
                </div>
                <div class="curso4" id="c4">
                    <h2>Proyecto de Investigación</h2>
                    <p>Descripcion</p>
                </div>
                <div class="curso5" id="c5">
                    <h2>Inglés </h2>
                    <p>Comunicación Interpersonal</p>
                </div>
                <div class="curso6" id="c6">
                    <h2>Metodologías de Desarrollo</h2>
                    <p>Descripción</p>
                </div>
            </div>
        </div>

        <div class="panel-curso">
            <div class="panelCurso1">
                <h2>Tabla de Notas</h2>
                <table id="tablaCurso1">
                    <thead>
                        <tr>
                            <th>Alumno</th>
                            <th>Unidad 1</th>
                            <th>Unidad 2</th>
                            <th>Examen Final</th>
                            <th class="prom">Promedio</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td> John Zorrilla</td>
                            <td>11</td>
                            <td>14</td>
                            <td>13</td>
                            <td>12</td>
                        </tr>
                    </tbody>
                </table>
                <button onclick="mostrarFormularioAgregarNota('tablaCurso1')">➕</button>
            </div>

            <div class="panelCurso2">
                <h2>Tabla de Notas</h2>
                <table id="tablaCurso2">
                    <thead>
                        <tr>
                            <th>Unidad 1</th>
                            <th>Unidad 2</th>
                            <th>Examen Final</th>
                            <th class="prom">Promedio</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>16</td>
                            <td>15</td>
                            <td>17</td>
                            <td>15</td>
                        </tr>
                    </tbody>
                </table>
                <button onclick="mostrarFormularioAgregarNota('tablaCurso2')">➕</button>
                <button id="btnanterior2">Anterior</button>
            </div>

            <div class="panelCurso3">
                <h2>Tabla de Notas</h2>
                <table id="tablaCurso3">
                    <thead>
                        <tr>
                            <th>Unidad 1</th>
                            <th>Unidad 2</th>
                            <th>Examen Final</th>
                            <th class="prom">Promedio</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>19</td>
                            <td>20</td>
                            <td>18</td>
                            <td>19</td>
                        </tr>
                    </tbody>
                </table>
                <button onclick="mostrarFormularioAgregarNota('tablaCurso3')">➕</button>
                <button id="btnanterior3">Anterior</button>
            </div>

            <div class="panelCurso4">
                <h2>Tabla de Notas</h2>
                <table id="tablaCurso4">
                    <thead>
                        <tr>
                            <th>Unidad 1</th>
                            <th>Unidad 2</th>
                            <th>Examen Final</th>
                            <th class="prom">Promedio</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>14</td>
                            <td>14</td>
                            <td>19</td>
                            <td>15</td>
                        </tr>
                    </tbody>
                </table>
                <button onclick="mostrarFormularioAgregarNota('tablaCurso4')">➕</button>
                <button id="btnanterior4">Anterior</button>
            </div>

            <div class="panelCurso5">
                <h2>Tabla de Notas</h2>
                <table id="tablaCurso5">
                    <thead>
                        <tr>
                            <th>Unidad 1</th>
                            <th>Unidad 2</th>
                            <th>Examen Final</th>
                            <th class="prom">Promedio</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>11</td>
                            <td>12</td>
                            <td>18</td>
                            <td>15</td>
                        </tr>
                    </tbody>
                </table>
                <button onclick="mostrarFormularioAgregarNota('tablaCurso5')">➕</button>
                <button id="btnanterior5">Anterior</button>
            </div>

            <div class="panelCurso6">
                <h2>Tabla de Notas</h2>
                <table id="tablaCurso6">
                    <thead>
                        <tr>
                            <th>Unidad 1</th>
                            <th>Unidad 2</th>
                            <th>Examen Final</th>
                            <th class="prom">Promedio</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>17</td>
                            <td>20</td>
                            <td>18</td>
                            <td>18</td>
                        </tr>
                    </tbody>
                </table>
                <button onclick="mostrarFormularioAgregarNota('tablaCurso6')">➕</button>
                <button id="btnanterior6">Anterior</button>
            </div>
            
            <div id="formAgregarNota" style="display: none;">
                <input type ="text" id = "nombreAlumno" placeholder="Nombre">
                <input type="number" id="notaUnidad1" placeholder="Nota Unidad 1">
                <input type="number" id="notaUnidad2" placeholder="Nota Unidad 2">
                <input type="number" id="notaExamenFinal" placeholder="Nota Examen Final">
                <button onclick="agregarNota(idTablaActiva)">✅</button>
            </div>

            <button id="btnExportar" class="btnexpo">
                <i class="fas fa-file-excel"></i> Exportar Datos
            </button>
                <button id="btnanterior">Anterior</button>
        </div>

        <div class="panel-user">
            <div class="content">
                <p class="inf">Nombres:</p>
                <p>Lucero Margarita</p>
                <p class="inf">Apellidos: </p>
                <p>Changra Mendoza</p>
                <p class="inf">Programa de estudios:</p>
                <p>Computación e Informática</p>
                <p class="inf">Ciclo:</p>
                <p>4to</p>
                <p class="inf">Año de ingreso:</p>
                <p>2022</p>
            </div>
            <h1>Perfil</h1>
            <img src="imagenes/user2.png" alt="cargando">
        </div>

        <div class="panel-estadistica">
            <div class="reporte">
                <h1> Reporte</h1>
                <img src="imagenes/est.png">
            </div>
        </div>
    </section>

    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="logica.js"></script>

    <!-- Script para exportar a Excel -->
    <script>
        const $btnExportar = document.querySelector("#btnExportar"),
            $tabla = document.querySelector("#tabla");

        $btnExportar.addEventListener("click", function() {
            let tableExport = new TableExport($tabla, {
                exportButtons: false,
                filename: "Reporte",
                sheetname: "Reporte",
            });
            let datos = tableExport.getExportData();
            let preferenciasDocumento = datos.tabla.xlsx;
            tableExport.export2file(preferenciasDocumento.data, preferenciasDocumento.mimeType, preferenciasDocumento.filename, preferenciasDocumento.fileExtension, preferenciasDocumento.merges, preferenciasDocumento.RTL, preferenciasDocumento.sheetname);
        });
    </script>
</body>

</html>
